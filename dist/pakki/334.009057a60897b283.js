"use strict";(self.webpackChunkpakki=self.webpackChunkpakki||[]).push([[334],{74334:(O,m,n)=>{n.r(m),n.d(m,{AuthModule:()=>E});var p=n(94666),g=n(69706),t=n(2508),v=n(5830),C=n(22607),Z=n(60598),u=n.n(Z),e=n(22560),w=n(25502),y=n(73071),k=n(44792),d=n(75074),I=n(84522),T=n(57822),h=n(31267);let J=(()=>{class a{constructor(){this.showPass=!1}ngOnInit(){}}return a.\u0275fac=function(o){return new(o||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-buttonpassword"]],inputs:{password:"password",placeholder:"placeholder"},decls:5,vars:6,consts:[[1,"example-form"],[1,"example-full-width"],["matInput","",3,"type","formControl","placeholder"],["matSuffix","",3,"click"],[2,"cursor","pointer"]],template:function(o,s){1&o&&(e.TgZ(0,"form",0)(1,"mat-form-field",1),e._UZ(2,"input",2),e.TgZ(3,"mat-icon",3),e.NdJ("click",function(){return s.showPass=!s.showPass}),e._UZ(4,"i",4),e.qZA()()()),2&o&&(e.xp6(2),e.s9C("type",s.showPass?"text":"password"),e.Q6J("formControl",s.password)("placeholder",s.placeholder),e.xp6(2),e.Gre("fa fa-",s.showPass?"eye":"eye-slash",""))},dependencies:[t._Y,t.Fj,t.JJ,t.JL,t.F,T.Hw,d.KE,d.R9,h.Nt,t.oH],styles:["\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJidXR0b25wYXNzd29yZC5jb21wb25lbnQuY3NzIn0= */"]}),a})();var f=n(50635),L=n(44874),b=n(88550),A=n(70207);function U(a,r){if(1&a){const o=e.EpF();e.TgZ(0,"mat-option",3),e.NdJ("click",function(){const l=e.CHM(o).$implicit,c=e.oxw();return e.KtG(c.sedeSelect(l))}),e.TgZ(1,"span",4),e._uU(2),e.qZA()()}if(2&a){const o=r.$implicit;e.Q6J("value",o.tradename),e.xp6(2),e.Oqu(o.tradename)}}let B=(()=>{class a{constructor(){this.sede=new t.NI(""),this.label="",this.sedeCambiada=new e.vpe,console.log("this.sedes:",this.sedes),this.filteredSedes=this.sede.valueChanges.pipe((0,f.U)(o=>o?this._filterSedes(o):this.sedes))}ngOnInit(){}ngOnChanges(o){o.sedes&&(this.filteredSedes=this.sede.valueChanges.pipe((0,L.O)(""),(0,f.U)(s=>this._filterSedes(s))))}_filterSedes(o){if(!this.sedes)return[];const s=o.toLowerCase();return this.sedes.filter(i=>i.tradename.toLowerCase().includes(s))}sedeSelect(o){this.sedeCambiada.emit({propiedad:"sede_seleccionada",value:o})}}return a.\u0275fac=function(o){return new(o||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-searchsedes"]],inputs:{label:"label",sedes:"sedes"},outputs:{sedeCambiada:"sedeCambiada"},features:[e.TTD],decls:8,vars:6,consts:[["matInput","","aria-label","Envio","placeholder","Aliados",3,"matAutocomplete","formControl"],["auto","matAutocomplete"],[3,"value","click",4,"ngFor","ngForOf"],[3,"value","click"],[1,"ml-3"]],template:function(o,s){if(1&o&&(e.TgZ(0,"mat-form-field")(1,"mat-label"),e._uU(2),e.qZA(),e._UZ(3,"input",0),e.TgZ(4,"mat-autocomplete",null,1),e.YNc(6,U,3,2,"mat-option",2),e.ALo(7,"async"),e.qZA()()),2&o){const i=e.MAs(5);e.xp6(2),e.Oqu(s.label),e.xp6(1),e.Q6J("matAutocomplete",i)("formControl",s.sede),e.xp6(3),e.Q6J("ngForOf",e.lcZ(7,4,s.filteredSedes))}},dependencies:[p.sg,t.Fj,t.JJ,b.XC,b.ZL,A.ey,d.KE,d.hX,h.Nt,t.oH,p.Ov],styles:["\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzZWFyY2hzZWRlcy5jb21wb25lbnQuY3NzIn0= */"]}),a})();function N(a,r){1&a&&(e.TgZ(0,"mat-error"),e._uU(1," Las contrase\xf1as no "),e.TgZ(2,"strong"),e._uU(3,"coinciden"),e.qZA()())}const M=[{path:"",children:[{path:"login",component:(()=>{class a{constructor(o,s,i,l,c,Y,X){this.element=o,this.apiservice=s,this.router=i,this.formBuilder=l,this.sweetalertservice=c,this.cookieService=Y,this.userservice=X,this.test=new Date,this.formLogin=new t.cw({email:new t.NI(""),pass:new t.NI("")}),this.ischeck=!0,this.sedes=[],this.nativeElement=o.nativeElement,this.sidebarVisible=!1,this.cookieService.get("token")&&window.history.go(-1)}ngOnInit(){window.$=$,this.toggleButton=this.element.nativeElement.getElementsByClassName("navbar-toggle")[0];const s=document.getElementsByTagName("body")[0];s.classList.add("login-page"),s.classList.add("off-canvas-sidebar");const i=document.getElementsByClassName("card")[0];setTimeout(function(){i.classList.remove("card-hidden")},700),this.formLogin=this.formBuilder.group({email:new t.NI("",[t.kI.required]),pass:new t.NI("",[t.kI.required])}),this.changepass=this.formBuilder.group({document:["",t.kI.required],password:["",t.kI.required,t.kI.minLength(6)],validatepassword:["",t.kI.required,t.kI.minLength(6)]})}sidebarToggle(){var o=this.toggleButton,s=document.getElementsByTagName("body")[0];document.getElementsByClassName("navbar-collapse"),0==this.sidebarVisible?(setTimeout(function(){o.classList.add("toggled")},500),s.classList.add("nav-open"),this.sidebarVisible=!0):(this.toggleButton.classList.remove("toggled"),this.sidebarVisible=!1,s.classList.remove("nav-open"))}ngOnDestroy(){const o=document.getElementsByTagName("body")[0];o.classList.remove("login-page"),o.classList.remove("off-canvas-sidebar")}login(){localStorage.clear();const o=u().fire({title:"Enviando Informaci\xf3n...",allowOutsideClick:!1,didOpen:()=>{u().showLoading()}});this.apiservice.post("lg",this.formLogin.value).subscribe(s=>{o.close(),this.cookieService.set("token",s.token),this.validarSedes()},s=>{console.log("error en el login",s),o.close(),this.sweetalertservice.errorMessage(s.error.msg?s.error.msg:"Error en login")})}closeModal(){$("#myModal").modal("hide"),localStorage.setItem("changepass","false"),localStorage.setItem("selectsucursal",JSON.stringify(this.sedeselected)),this.router.navigate(["quoter/quotation"])}openModal(o){$(o).modal("show")}ischecked(){this.ischeck=!this.ischeck}validarSedes(){this.apiservice.post("rgs/token").subscribe(o=>{if(0==o.data.collaborator.changePass)return this.setPass("true"),void this.openModal("#changepass");this.data_collaborator=o.data.collaborator,localStorage.setItem("dataUser",JSON.stringify(o.data)),"Pakki"!=this.data_collaborator.profile?"Owner"!=this.data_collaborator.profile?"CEI"==this.data_collaborator.profile&&(this.setPass("false"),this.router.navigate(["quoter/quotation"])):this.getDataBusiness():this.getDataBusinessPakki()},o=>{console.log("error en validar sedes",o),this.sweetalertservice.errorMessage("Error en la validacion de sedes")})}getDataBusinessPakki(){this.apiservice.post("bs/allbuspk",this.bodyBussiness).subscribe(s=>{console.log(s),s.ViewBussPakki.length>0&&s.ViewBussPakki.forEach(i=>{i.branchofficesCount<=0||("Pakki"===i.business.businessname?this.sedes=i.branchoffices:i.branchoffices.forEach(l=>{this.sedes.push({tradename:`${i.business.businessname},${l.tradename}`,_id:l._id})}))}),console.log(this.sedes),this.sedes.length>1?$("#myModal").modal("show"):(this.setPass("false"),this.router.navigate(["quoter/quotation"]))},s=>{console.log("Error al consultar sedes",s),this.sweetalertservice.errorMessage("Error al consultar sedes")})}getDataBusiness(){this.apiservice.post("bs/allbusali",this.bodyBussiness).subscribe(s=>{console.log(s),s.ViewBussPakki.length>0&&s.ViewBussPakki.forEach(i=>{i.branchofficesCount<=0||(this.sedes=i.branchoffices)}),console.log(this.sedes),this.sedes.length>1?$("#myModal").modal("show"):(this.setPass("false"),this.router.navigate(["quoter/quotation"]))},s=>{console.log("Error al consultar sedes Aliado",s),this.sweetalertservice.errorMessage("Error al consultar sedes")})}get bodyBussiness(){let o=this.userservice.getAllInfoUser();return{nit:o.business.businessNit,collaborators:o.collaborator.id}}changePass(){this.apiservice.put("cl/changepass",this.changepass.value).subscribe(o=>{console.log(o),u().fire({title:o.msg,confirmButtonText:"Aceptar"}).then(s=>{s.isConfirmed&&(localStorage.clear(),window.location.reload())})},o=>{console.log("error en actualizaci\xf3n de contrase\xf1a",o),this.sweetalertservice.errorMessage("Error en actualizaci\xf3n de contrase\xf1a")})}sedeChange(o){console.log("recibido en el padre",o),this.sedeselected=o.value,console.log(this.sedeselected)}setPass(o){localStorage.setItem("changepass",o)}}return a.\u0275fac=function(o){return new(o||a)(e.Y36(e.SBq),e.Y36(v.s),e.Y36(g.F0),e.Y36(t.qu),e.Y36(C.P),e.Y36(w.N),e.Y36(y.K))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-login-cmp"]],decls:85,vars:16,consts:[[1,"wrapper","wrapper-full-page"],[1,"page-header","login-page","header-filter",2,"background-image","url('./assets/img/fondo-black.jpg')","background-size","cover","background-position","top center"],[1,"container"],[1,"row"],[1,"col-lg-4","col-md-6","col-sm-6","ml-auto","mr-auto"],[1,"text-center"],["src","/assets/img/logo_pakki.png"],[1,"form",3,"formGroup"],[1,"card","card-login","card-hidden"],[1,"card-header","card-header-warning","text-center"],[1,"card-title"],[1,"card-body"],[1,"bmd-form-group"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"material-icons"],["type","email","formControlName","email","placeholder","Usuario...",1,"form-control"],["type","password","formControlName","pass","placeholder","Password...",1,"form-control"],[1,"text-center","mt-2"],[1,"col-10","align-self-center"],[1,"",3,"checked","change"],["href","https://pakki.co/terminos.html","target","_blank",2,"color","blue"],[1,"card-footer","justify-content-center"],[1,"card-footer"],["mat-raised-button","","type","button",1,"btn","btn-fill","btn-primary",3,"disabled","click"],["id","myModal","data-backdrop","static","data-keyboard","false","tabindex","-1","role","dialog",1,"modal","fade"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],[1,"modal-body"],[1,"row","mb-1"],[1,"col-12","text-center"],[1,"col-12"],[1,"ml-3"],[1,"col","align-self-start"],[1,"",3,"sedes","label","sedeCambiada"],[1,"modal-footer"],["type","button",1,"btn","btn-fill","btn-primary",3,"disabled","click"],["id","changepass","data-backdrop","static","data-keyboard","false","tabindex","-1","role","dialog",1,"modal","fade"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[3,"formGroup"],[1,"col-xl-12"],[3,"placeholder","password"],[4,"ngIf"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),e._UZ(6,"img",6),e.qZA()()(),e.TgZ(7,"div",3)(8,"div",4)(9,"form",7)(10,"div",8)(11,"div",9)(12,"h4",10),e._uU(13,"Log in"),e.qZA()(),e.TgZ(14,"div",11)(15,"span",12)(16,"div",13)(17,"div",14)(18,"span",15)(19,"i",16),e._uU(20,"email"),e.qZA()()(),e._UZ(21,"input",17),e.qZA()(),e.TgZ(22,"span",12)(23,"div",13)(24,"div",14)(25,"span",15)(26,"i",16),e._uU(27,"lock_outline"),e.qZA()()(),e._UZ(28,"input",18),e.qZA()(),e.TgZ(29,"div",19)(30,"div",3)(31,"div",20)(32,"mat-checkbox",21),e.NdJ("change",function(){return s.ischecked()}),e._uU(33,"Acepta "),e.TgZ(34,"a",22),e._uU(35,"t\xe9rminos y condiciones "),e.qZA()()()()()(),e.TgZ(36,"div",23)(37,"div",24)(38,"button",25),e.NdJ("click",function(){return s.login()}),e._uU(39," Acceder "),e.qZA()()()()()()()()()(),e.TgZ(40,"div",26)(41,"div",27)(42,"div",28)(43,"div",29),e._UZ(44,"h5",30),e.qZA(),e.TgZ(45,"div",31)(46,"div",32)(47,"div",33)(48,"h3",10),e._uU(49," Bienvenido: "),e.TgZ(50,"b"),e._uU(51),e.qZA()()()(),e.TgZ(52,"div",3)(53,"div",34)(54,"p",35)(55,"b"),e._uU(56,"Por favor selecciona la compa\xf1ia a Ingresar:"),e.qZA()()()(),e.TgZ(57,"div",36)(58,"app-searchsedes",37),e.NdJ("sedeCambiada",function(l){return s.sedeChange(l)}),e.qZA()()(),e.TgZ(59,"div",38)(60,"button",39),e.NdJ("click",function(){return s.closeModal()}),e._uU(61," Continuar "),e.qZA()()()()(),e.TgZ(62,"div",40)(63,"div",27)(64,"div",28)(65,"div",29)(66,"h5",30),e._uU(67,"Cambiar Contrase\xf1a"),e.qZA(),e.TgZ(68,"button",41)(69,"span",42),e._uU(70,"\xd7"),e.qZA()()(),e.TgZ(71,"div",31)(72,"form",43)(73,"div",3)(74,"div",44),e._UZ(75,"app-buttonpassword",45),e.qZA(),e.TgZ(76,"div",44),e._UZ(77,"app-buttonpassword",45),e.qZA(),e.TgZ(78,"div",44),e._UZ(79,"app-buttonpassword",45),e.qZA(),e.TgZ(80,"div",44),e.YNc(81,N,4,0,"mat-error",46),e.qZA()()()(),e.TgZ(82,"div",38)(83,"button",39),e.NdJ("click",function(){return s.changePass()}),e._uU(84," Continuar "),e.qZA()()()()()),2&o&&(e.xp6(9),e.Q6J("formGroup",s.formLogin),e.xp6(23),e.Q6J("checked",s.ischeck),e.xp6(6),e.Q6J("disabled",!s.ischeck||s.formLogin.invalid),e.xp6(13),e.Oqu(null==s.data_collaborator?null:s.data_collaborator.name),e.xp6(7),e.Q6J("sedes",s.sedes)("label","Aliados"),e.xp6(2),e.Q6J("disabled",!s.sedeselected),e.xp6(12),e.Q6J("formGroup",s.changepass),e.xp6(3),e.Q6J("placeholder","Contrase\xf1a Anterior")("password",s.changepass.get("document")),e.xp6(2),e.Q6J("placeholder","Contrase\xf1a")("password",s.changepass.controls.password),e.xp6(2),e.Q6J("placeholder","Confirmar Contrase\xf1a")("password",s.changepass.controls.validatepassword),e.xp6(2),e.Q6J("ngIf",s.changepass.get("password").value!=s.changepass.get("validatepassword").value&&s.changepass.get("password").touched&&s.changepass.get("validatepassword").touched),e.xp6(2),e.Q6J("disabled",s.changepass.invalid||s.changepass.get("password").value!==s.changepass.get("validatepassword").value))},dependencies:[p.O5,t._Y,t.Fj,t.JJ,t.JL,k.oG,d.TO,I.lW,t.sg,t.u,J,B],styles:[".primary-color[_ngcontent-%COMP%] {\r\n  background-color: rgb(255, 196, 0);\r\n}\r\n.modal-dialog[_ngcontent-%COMP%] {\r\n  box-shadow: -35px 54px 35px -10px rgb(17, 17, 17);\r\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvZ2luLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxrQ0FBa0M7QUFDcEM7QUFDQTtFQUNFLGlEQUFpRDtBQUNuRCIsImZpbGUiOiJsb2dpbi5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLnByaW1hcnktY29sb3Ige1xyXG4gIGJhY2tncm91bmQtY29sb3I6IHJnYigyNTUsIDE5NiwgMCk7XHJcbn1cclxuLm1vZGFsLWRpYWxvZyB7XHJcbiAgYm94LXNoYWRvdzogLTM1cHggNTRweCAzNXB4IC0xMHB4IHJnYigxNywgMTcsIDE3KTtcclxufVxyXG4iXX0= */"]}),a})()}]}];var S=n(23367),F=n(71969);let E=(()=>{class a{}return a.\u0275fac=function(o){return new(o||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[p.ez,g.Bz.forChild(M),t.u5,S.q,t.UX,F.K]}),a})()}}]);
//# sourceMappingURL=334.009057a60897b283.js.map