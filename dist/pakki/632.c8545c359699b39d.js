"use strict";(self.webpackChunkpakki=self.webpackChunkpakki||[]).push([[632],{57632:(Y,f,r)=>{r.r(f),r.d(f,{ShipmentsModule:()=>D});var d=r(94666),i=r(2508),v=r(50253),Z=r(68951),p=r(5830),g=r(22607),e=r(22560),m=r(75074),u=r(31267),h=r(10745),C=r(88550),_=r(70207);function y(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"mat-option",5),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.AliadoSelect(s))}),e.TgZ(1,"span",6),e._uU(2),e.qZA()()}if(2&o){const t=l.$implicit;e.Q6J("value",t.value),e.xp6(2),e.Oqu(t.name)}}let I=(()=>{class o{constructor(t){this.apiservice=t,this.aliadoCambiado=new e.vpe,this.data_aliados=[]}ngOnInit(){}onKeyUp(){const t=this.nitctr.value;t.length>3?(this.data_aliados=[],this.filteredAliados=(0,h.of)([]),this.apiservice.post("bs/bussearch",{brachOffice:t,guideNumber:""}).subscribe(a=>{this.dataresponse=a,a.tradenames.forEach(s=>{this.data_aliados.push({name:s,value:s})}),this.filteredAliados=(0,h.of)(this.data_aliados)},a=>{console.error("Error en la consulta de Nombre de Negocio:",a),this.data_aliados=[]})):(this.data_aliados=[],this.filteredAliados=(0,h.of)([]))}AliadoSelect(t){this.filteredAliados=(0,h.of)([]),this.aliadoCambiado.emit({propiedad:"aliado_seleccionado",valor:t})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.s))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-input-namebranch"]],inputs:{nitctr:"nitctr",label:"label"},outputs:{aliadoCambiado:"aliadoCambiado"},decls:9,vars:6,consts:[[1,"example-form"],[1,"example-full-width"],["matInput","","aria-label","Envio",3,"matAutocomplete","formControl","input"],["auto","matAutocomplete"],[3,"value","click",4,"ngFor","ngForOf"],[3,"value","click"],[1,"ml-3"]],template:function(t,n){if(1&t&&(e.TgZ(0,"form",0)(1,"mat-form-field",1)(2,"mat-label"),e._uU(3),e.qZA(),e.TgZ(4,"input",2),e.NdJ("input",function(){return n.onKeyUp()}),e.qZA(),e.TgZ(5,"mat-autocomplete",null,3),e.YNc(7,y,3,2,"mat-option",4),e.ALo(8,"async"),e.qZA()()()),2&t){const a=e.MAs(6);e.xp6(3),e.Oqu(n.label),e.xp6(1),e.Q6J("matAutocomplete",a)("formControl",n.nitctr),e.xp6(3),e.Q6J("ngForOf",e.lcZ(8,4,n.filteredAliados))}},dependencies:[d.sg,i._Y,i.Fj,i.JJ,i.JL,i.F,C.XC,C.ZL,_.ey,m.KE,m.hX,u.Nt,i.oH,d.Ov],encapsulation:2}),o})();var b=r(92302);let N=(()=>{class o{constructor(t,n){this.apiservice=t,this.sweetalertservice=n,this.data={},this.comment="",this.commentCreated=new e.vpe,this.estado=!0}createComment(){this.data.comment=this.comment,this.data.status=1==this.estado?"Abierto":"Cerrado",this.apiservice.post("sps/shipcomm",this.data).subscribe(t=>{this.sweetalertservice.showNotification(t.msg),this.comment="",this.commentCreated.emit({propiedad:"comment_created",valor:!0})},t=>{console.error("Error al crear comentario",t),this.sweetalertservice.errorMessage(t.error.msg?t.error.msg:"Error al crear comentario")})}selectPickup(t){this.estado=t}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.s),e.Y36(g.P))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-generatecomment"]],inputs:{data:"data",estado:"estado"},outputs:{commentCreated:"commentCreated"},decls:23,vars:3,consts:[["id","generatecomment","data-backdrop","static","data-keyboard","false","tabindex","-1","role","dialog",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"container-fluid"],[1,"row"],[1,"col-1","offset-11"],[1,"togglebutton"],["type","checkbox",3,"checked","change"],[1,"toggle"],[1,"col"],["matInput","","placeholder","Comentario","type","text",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-warning","float-right",3,"disabled","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4),e._uU(5,"Generar Comentarios"),e.qZA(),e.TgZ(6,"button",5)(7,"span",6),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",7)(10,"div",8)(11,"div",9)(12,"div",10)(13,"div",11)(14,"label")(15,"input",12),e.NdJ("change",function(s){return n.selectPickup(s.target.checked)}),e.qZA(),e._UZ(16,"span",13),e.qZA()()()(),e.TgZ(17,"div",9)(18,"div",14)(19,"mat-form-field")(20,"input",15),e.NdJ("ngModelChange",function(s){return n.comment=s}),e.qZA()()()(),e.TgZ(21,"button",16),e.NdJ("click",function(){return n.createComment()}),e._uU(22," Generar Comentario "),e.qZA()()()()()()),2&t&&(e.xp6(15),e.Q6J("checked",n.estado),e.xp6(5),e.Q6J("ngModel",n.comment),e.xp6(1),e.Q6J("disabled",!n.comment))},dependencies:[i.Fj,i.JJ,i.On,m.KE,u.Nt],styles:["\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJnZW5lcmF0ZWNvbW1lbnQuY29tcG9uZW50LmNzcyJ9 */"]}),o})();function T(o,l){if(1&o&&(e.TgZ(0,"div",11)(1,"h6"),e._uU(2),e.qZA(),e.TgZ(3,"mat-form-field",12),e._UZ(4,"textarea",13),e.qZA()()),2&o){const t=l.$implicit,n=l.index;e.xp6(2),e.xDo(" Comentario ",n+1,""," ","-",t.name," ",t.lastname," -",t.dateUpdate," "),e.xp6(2),e.Q6J("value",t.observation)("rows",t.observation.length>50?"4":"1")}}let w=(()=>{class o{constructor(t,n){this.apiservice=t,this.sweetalertservice=n,this.data=[]}ngOnInit(){}closeModal(t){$(`#${t}`).modal("hide")}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.s),e.Y36(g.P))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-seallcomments"]],inputs:{data:"data"},decls:15,vars:1,consts:[["id","seallcomment","data-backdrop","static","data-keyboard","false","tabindex","-1","role","dialog",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"container-fluid"],[1,"row"],["class","col-12",4,"ngFor","ngForOf"],[1,"col-12"],["appearance","fill"],["matInput","","readonly","",3,"value","rows"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h4",4),e._uU(5,"Ver Comentarios"),e.qZA(),e.TgZ(6,"button",5),e.NdJ("click",function(){return n.closeModal("seallcomment")}),e.TgZ(7,"span",6),e._uU(8,"\xd7"),e.qZA()()(),e.TgZ(9,"div",7)(10,"div",8)(11,"div")(12,"div",9),e.YNc(13,T,5,7,"div",10),e.qZA(),e._UZ(14,"hr"),e.qZA()()()()()()),2&t&&(e.xp6(13),e.Q6J("ngForOf",n.data))},dependencies:[d.sg,m.KE,u.Nt],styles:[".row-largo[_ngcontent-%COMP%] {\r\n  \r\n  rows: 6; \r\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlYWxsY29tbWVudHMuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLCtEQUErRDtFQUMvRCxPQUFPLEVBQUUsOENBQThDO0FBQ3pEIiwiZmlsZSI6InNlYWxsY29tbWVudHMuY29tcG9uZW50LmNzcyIsInNvdXJjZXNDb250ZW50IjpbIi5yb3ctbGFyZ28ge1xyXG4gIC8qIERlZmluZSBhcXXDrSBlbCBlc3RpbG8gcXVlIGRlc2VhcyBhcGxpY2FyIGFsIHRleHRhcmVhIGxhcmdvICovXHJcbiAgcm93czogNjsgLyogUHVlZGVzIGFqdXN0YXIgZXN0byBzZWfDum4gdHVzIG5lY2VzaWRhZGVzICovXHJcbn1cclxuIl19 */"]}),o})(),A=(()=>{class o{transform(t,n){return t&&n?(n=n.toLowerCase(),t.filter(a=>{const s=a.shipment.ShipmentCode,c=a.Destination.cityDestination.cityName.toLowerCase(),W=a.Provider?.partners.toLowerCase();return s.includes(n)||c.includes(n)||W.includes(n)})):t}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=e.Yjl({name:"searchshipment",type:o,pure:!0}),o})();function J(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"tr",30)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td"),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td")(12,"button",33),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.openModal("generatecomment",s))}),e.TgZ(13,"span",34),e._uU(14," post_add "),e.qZA()(),e.TgZ(15,"button",33),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.getComentarios(s))}),e.TgZ(16,"span",34),e._uU(17," visibility "),e.qZA()(),e.TgZ(18,"button",35),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.downloadPdf(s.ShipmentID))}),e.TgZ(19,"span",34),e._uU(20," download "),e.qZA()()()()}if(2&o){const t=l.$implicit;e.xp6(2),e.Oqu(null==t||null==t.shipment?null:t.shipment.ShipmentCode),e.xp6(2),e.Oqu(null==t||null==t.business?null:t.business.brachOffice),e.xp6(2),e.Oqu(null==t||null==t.Destination||null==t.Destination.cityDestination?null:t.Destination.cityDestination.cityName),e.xp6(2),e.Oqu(null==t||null==t.Provider?null:t.Provider.partners),e.xp6(2),e.Oqu(null==t?null:t.dateCreate)}}const U=function(o){return{itemsPerPage:10,currentPage:o}};function x(o,l){if(1&o){const t=e.EpF();e.TgZ(0,"div",27)(1,"div",4)(2,"div",28)(3,"table",29)(4,"thead",30)(5,"tr")(6,"th"),e._uU(7,"Guia"),e.qZA(),e.TgZ(8,"th"),e._uU(9,"Nombre de Oficina"),e.qZA(),e.TgZ(10,"th"),e._uU(11,"Destino"),e.qZA(),e.TgZ(12,"th"),e._uU(13,"Proveedor"),e.qZA(),e.TgZ(14,"th"),e._uU(15,"Fecha Creaci\xf3n"),e.qZA(),e.TgZ(16,"th"),e._uU(17,"Acciones"),e.qZA()()(),e.TgZ(18,"tbody"),e.YNc(19,J,21,5,"tr",31),e.ALo(20,"paginate"),e.ALo(21,"searchshipment"),e.qZA()(),e.TgZ(22,"pagination-controls",32),e.NdJ("pageChange",function(a){e.CHM(t);const s=e.oxw();return e.KtG(s.p=a)}),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(19),e.Q6J("ngForOf",e.xi3(20,1,e.xi3(21,4,t.dataShipments,t.filter),e.VKq(7,U,t.p)))}}const V=[{path:"",children:[{path:"viewall",component:(()=>{class o{constructor(t,n){this.apiservice=t,this.sweetalertservice=n,this.searchcompany=new i.cw({businessname:new i.NI("",[i.kI.required]),guideNumber:new i.NI("",[i.kI.required]),businessnit:new i.NI("",[i.kI.required]),business:new i.NI(""),brachOffice:new i.NI("",[i.kI.required]),branchselected:new i.NI("",[i.kI.required]),branchid:new i.NI("")}),this.businessNameChanged$=new v.x,this.unsubscribe$=new v.x,this.dataShipments=[],this.filter="",this.p=1,this.carta="",this.guia="",this.proforma="",this.datashipmentopen={},this.comentarios=[],this.timeout=null,this.estado=!0}ngOnInit(){this.searchcompany.get("businessname").valueChanges.pipe((0,Z.R)(this.unsubscribe$)).subscribe(t=>{this.businessNameChanged$.next(t),t.length>0&&this.searchcompany.patchValue({guideNumber:""})})}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}BusinessSelect(t){this.SendData()}SendData(){let t={brachOffice:this.searchcompany.get("businessname")?.value,guideNumber:this.searchcompany.get("guideNumber")?.value};this.apiservice.post("sps/viewshipments",t).subscribe(n=>{console.log("envios",n),0==n.msg.length&&this.sweetalertservice.showNotification("No se encontraron Coincidencias"),this.dataShipments=n.msg},n=>{console.error("Error Al consultar Shipment",n),this.sweetalertservice.showNotification(n.error.msg?n.error.msg:"Error Al consultar Shipment ")})}onKeyUpGuia(t){this.searchcompany.patchValue({businessname:""}),this.searchcompany.get("guideNumber")?.value.length>1&&(clearTimeout(this.timeout),this.timeout=setTimeout(()=>{console.log(this.searchcompany.value),this.SendData()},1e3))}branchSelect(t){console.log(t.valor),this.searchcompany.patchValue({branchid:t.valor._id}),console.log(this.searchcompany.value),this.SendData()}commentCreated(t){this.closeModal("generatecomment"),this.SendData()}downloadPdf(t){let n={ShipmentID:t};console.log("===================================="),console.log(n),console.log("===================================="),this.apiservice.post("sps/viewpdf",n).subscribe(a=>{console.log(a),a.msg.carta&&(this.carta=a.msg.carta),a.msg.guia&&(this.guia=a.msg.guia),a.msg.proforma&&(this.proforma=a.msg.proforma),this.openModal("view_docu")},a=>{console.error("Error al enviar informacion de crear Comercial",a),this.sweetalertservice.errorMessage(a.error.msg?a.error.msg:"Error Al Crear Comercial")})}openModal(t,n){n&&(this.datashipmentopen=n),$(`#${t}`).modal("show")}getComentarios(t){this.apiservice.post("sps/vwshipcomm",{ShipmentID:t.ShipmentID}).subscribe(a=>{1==a.ok&&(this.comentarios=a.msg.comments,this.estado="Abierto"==a.msg.status,this.openModal("seallcomment"))},a=>{console.error("Error al consultar comentarios",a),this.sweetalertservice.errorMessage(a.error.msg?a.error.msg:"Error Al consultar comentarios")})}closeModal(t){$(`#${t}`).modal("hide")}openDocument(t){window.open(t,"_blank")}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(p.s),e.Y36(g.P))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-viewallshipments"]],decls:41,vars:9,consts:[[1,"main-content"],[1,"container-fluid"],[1,"card"],[1,"row","p-3"],[1,"col-12"],["name","filtership","type","search","placeholder","Buscar...",1,"form-control",3,"ngModel","ngModelChange"],[3,"formGroup"],[1,"card","mt-1"],[1,"col-6"],[3,"nitctr","label","aliadoCambiado"],[1,"example-form"],[1,"example-full-width"],["matInput","","aria-label","name_buss",3,"formControl","input"],["class","row",4,"ngIf"],["id","view_docu","data-backdrop","static","data-keyboard","false","tabindex","-1","role","dialog",1,"modal","fade"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"row","mt-3"],[1,"col-4","text-center"],["type","button",1,"btn","btn-warning",3,"click"],[3,"estado","data","commentCreated"],[3,"data"],[1,"row"],[1,"table-responsive"],[1,"table"],[1,"text-black","text-center"],["class","text-black text-center",4,"ngFor","ngForOf"],["previousLabel","Anterior","nextLabel","Siguiente",1,"my-pagination","text-center",3,"pageChange"],[1,"btn","btn-warning","mt-1","btn-sm",3,"click"],[1,"material-symbols-outlined"],[1,"btn","btn-warning","btn-sm",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"input",5),e.NdJ("ngModelChange",function(s){return n.filter=s}),e.qZA()()()(),e.TgZ(6,"form",6)(7,"div",7)(8,"div",3)(9,"div",8)(10,"app-input-namebranch",9),e.NdJ("aliadoCambiado",function(s){return n.BusinessSelect(s)}),e.qZA()(),e.TgZ(11,"div",8)(12,"form",10)(13,"mat-form-field",11)(14,"mat-label"),e._uU(15,"Numero de Guia"),e.qZA(),e.TgZ(16,"input",12),e.NdJ("input",function(s){return n.onKeyUpGuia(s)}),e.qZA()()()()(),e.YNc(17,x,23,9,"div",13),e.qZA()()()(),e.TgZ(18,"div",14)(19,"div",15)(20,"div",16)(21,"div",17)(22,"h4",18),e._uU(23,"Descargar Documentos"),e.qZA(),e.TgZ(24,"button",19)(25,"span",20),e._uU(26,"\xd7"),e.qZA()()(),e.TgZ(27,"div",21)(28,"div",1)(29,"div",22)(30,"div",23)(31,"button",24),e.NdJ("click",function(){return n.openDocument(n.guia)}),e._uU(32," Gu\xeda "),e.qZA()(),e.TgZ(33,"div",23)(34,"button",24),e.NdJ("click",function(){return n.openDocument(n.carta)}),e._uU(35," carta "),e.qZA()(),e.TgZ(36,"div",23)(37,"button",24),e.NdJ("click",function(){return n.openDocument(n.proforma)}),e._uU(38," Proforma "),e.qZA()()()()()()()(),e.TgZ(39,"app-generatecomment",25),e.NdJ("commentCreated",function(s){return n.commentCreated(s)}),e.qZA(),e._UZ(40,"app-seallcomments",26)),2&t&&(e.xp6(5),e.Q6J("ngModel",n.filter),e.xp6(1),e.Q6J("formGroup",n.searchcompany),e.xp6(4),e.Q6J("nitctr",n.searchcompany.get("businessname"))("label","Nombre del negocio"),e.xp6(6),e.Q6J("formControl",n.searchcompany.get("guideNumber")),e.xp6(1),e.Q6J("ngIf",n.dataShipments.length>0),e.xp6(22),e.Q6J("estado",n.estado)("data",n.datashipmentopen),e.xp6(1),e.Q6J("data",n.comentarios))},dependencies:[d.sg,d.O5,i._Y,i.Fj,i.JJ,i.JL,i.On,i.F,m.KE,m.hX,u.Nt,i.oH,i.sg,I,b.LS,N,w,b._s,A],styles:[".my-pagination[_ngcontent-%COMP%]     .ngx-pagination .current {\r\n  background: orange !important;\r\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZpZXdhbGxzaGlwbWVudHMuY29tcG9uZW50LmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLDZCQUE2QjtBQUMvQiIsImZpbGUiOiJ2aWV3YWxsc2hpcG1lbnRzLmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyIubXktcGFnaW5hdGlvbiA6Om5nLWRlZXAgLm5neC1wYWdpbmF0aW9uIC5jdXJyZW50IHtcclxuICBiYWNrZ3JvdW5kOiBvcmFuZ2UgIWltcG9ydGFudDtcclxufVxyXG4iXX0= */"]}),o})()}]},{path:"**",redirectTo:"viewall",pathMatch:"full"}];var G=r(69706),F=r(72675),M=r(30858),S=r(58278),q=r(23367),k=r(71969),O=r(6917);let D=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[d.ez,G.Bz.forChild(V),i.u5,q.q,i.UX,k.K,M.TW,S.vO,F.IJ,O.z,b.JX,m.lN]}),o})()}}]);
//# sourceMappingURL=632.c8545c359699b39d.js.map